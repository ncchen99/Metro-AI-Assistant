# ğŸš‡ å°åŒ—æ·é‹æ™ºèƒ½åŠ©æ‰‹ (Metro AI Assistant)
## hi
<div align="center">

![Demo](docs/images/demo.png)

**é©å‘½æ€§çš„æ™ºèƒ½äº¤é€šåŠ©æ‰‹ï¼Œç‚ºæ‚¨çš„å°åŒ—æ·é‹ä¹‹æ—…æä¾›å€‹æ€§åŒ–AIé«”é©—**

[![Frontend](https://img.shields.io/badge/Frontend-metro--sense.vercel.app-blue?style=for-the-badge&logo=vercel)](https://metro-sense.vercel.app)
[![Backend API (Fly.io)](https://img.shields.io/badge/Backend-metro--sense.fly.dev-purple?style=for-the-badge&logo=fastapi)](https://metro-sense.fly.dev/docs)
[![Backup API (Render)](https://img.shields.io/badge/Backup-metro--sense.onrender.com-green?style=for-the-badge&logo=fastapi)](https://metro-sense.onrender.com/docs)

[![React](https://img.shields.io/badge/React-18.3.1-61DAFB?style=flat&logo=react&logoColor=white)](https://reactjs.org/)
[![FastAPI](https://img.shields.io/badge/FastAPI-Python-009688?style=flat&logo=fastapi&logoColor=white)](https://fastapi.tiangolo.com/)
[![OpenAI](https://img.shields.io/badge/OpenAI-GPT--4-412991?style=flat&logo=openai&logoColor=white)](https://openai.com/)
[![Vercel](https://img.shields.io/badge/Deployed%20on-Vercel-000000?style=flat&logo=vercel&logoColor=white)](https://vercel.com/)

</div>

## ğŸ“‹ ç›®éŒ„

- [ğŸŒŸ å°ˆæ¡ˆä»‹ç´¹](#-å°ˆæ¡ˆä»‹ç´¹)
- [âœ¨ ä¸»è¦åŠŸèƒ½](#-ä¸»è¦åŠŸèƒ½)
- [ğŸ› ï¸ æŠ€è¡“æ¶æ§‹](#ï¸-æŠ€è¡“æ¶æ§‹)
- [ğŸš€ å¿«é€Ÿé–‹å§‹](#-å¿«é€Ÿé–‹å§‹)
- [ğŸ“š API æ–‡æª”](#-api-æ–‡æª”)
- [ğŸŒ éƒ¨ç½²è³‡è¨Š](#-éƒ¨ç½²è³‡è¨Š)
- [ğŸ”§ é–‹ç™¼æŒ‡å—](#-é–‹ç™¼æŒ‡å—)
- [ğŸ“„ æˆæ¬Šæ¢æ¬¾](#-æˆæ¬Šæ¢æ¬¾)

## ğŸŒŸ å°ˆæ¡ˆä»‹ç´¹

å°åŒ—æ·é‹æ™ºèƒ½åŠ©æ‰‹æ˜¯ä¸€å€‹çµåˆäººå·¥æ™ºæ…§æŠ€è¡“çš„æ™ºèƒ½äº¤é€šæœå‹™å¹³å°ï¼Œå°ˆç‚ºå°åŒ—æ·é‹ç³»çµ±è¨­è¨ˆã€‚é€éå…ˆé€²çš„OpenAIæŠ€è¡“æ•´åˆï¼Œæä¾›ç”¨æˆ¶å€‹æ€§åŒ–çš„äº¤é€šè¦åŠƒã€æ™¯é»æ¨è–¦å’Œå³æ™‚è³‡è¨ŠæŸ¥è©¢æœå‹™ã€‚

### ğŸ¯ å°ˆæ¡ˆç›®æ¨™

- **æ™ºèƒ½åŒ–äº¤é€šè¦åŠƒ**: åˆ©ç”¨AIæä¾›æœ€ä½³è·¯ç·šå»ºè­°
- **å€‹æ€§åŒ–æœå‹™é«”é©—**: æ ¹æ“šç”¨æˆ¶éœ€æ±‚åˆ‡æ›å·¥ä½œ/æ—…éŠæ¨¡å¼
- **èªéŸ³äº’å‹•åŠŸèƒ½**: æ”¯æ´èªéŸ³è¼¸å…¥å’ŒèªéŸ³å›æ‡‰
- **å³æ™‚è³‡è¨Šæ•´åˆ**: æä¾›æœ€æ–°çš„æ·é‹ç‡Ÿé‹è³‡è¨Š

## âœ¨ ä¸»è¦åŠŸèƒ½

### ğŸ¤– AI æ™ºèƒ½åŠ©æ‰‹
- **é›™æ¨¡å¼åˆ‡æ›**: å·¥ä½œæ¨¡å¼å°ˆæ³¨é€šå‹¤éœ€æ±‚ï¼Œæ—…éŠæ¨¡å¼æä¾›æ™¯é»æ¨è–¦
- **è‡ªç„¶èªè¨€è™•ç†**: ç†è§£è¤‡é›œçš„ä¸­æ–‡æŸ¥è©¢éœ€æ±‚
- **å€‹æ€§åŒ–å›æ‡‰**: æ ¹æ“šç”¨æˆ¶åå¥½æä¾›å®¢è£½åŒ–å»ºè­°

### ğŸ—£ï¸ èªéŸ³äº’å‹•ç³»çµ±
- **èªéŸ³è½‰æ–‡å­—** (STT): æ”¯æ´å¤šç¨®éŸ³è¨Šæ ¼å¼ (mp3, wav, mp4, m4a, webm)
- **æ–‡å­—è½‰èªéŸ³** (TTS): å¤šç¨®èªéŸ³é¸é …å’ŒéŸ³è³ªè¨­å®š
- **å³æ™‚ä¸²æµå›æ‡‰**: ä½¿ç”¨ Server-Sent Events æä¾›æµæš¢çš„å°è©±é«”é©—

### ğŸ¨ ç¾ä»£åŒ–ä»‹é¢è¨­è¨ˆ
- **éŸ¿æ‡‰å¼è¨­è¨ˆ**: é©é…å„ç¨®è£ç½®å°ºå¯¸
- **æµæš¢å‹•ç•«æ•ˆæœ**: ä½¿ç”¨ Framer Motion æä¾›é †æ»‘çš„ä½¿ç”¨è€…é«”é©—
- **ç›´è§€æ“ä½œä»‹é¢**: ç°¡æ½”ç¾è§€çš„UI/UXè¨­è¨ˆ

### ğŸ”— æ™ºèƒ½è·¯ç·šè¦åŠƒ
- **å³æ™‚äº¤é€šè³‡è¨Š**: æ•´åˆæ·é‹ç‡Ÿé‹ç‹€æ…‹
- **å¤šå…ƒè·¯ç·šå»ºè­°**: æä¾›å¤šç¨®å¯é¸è·¯ç·šæ–¹æ¡ˆ
- **æ™¯é»æ¨è–¦ç³»çµ±**: åŸºæ–¼ä½ç½®çš„æ™ºèƒ½æ¨è–¦

## ğŸ› ï¸ æŠ€è¡“æ¶æ§‹

### å‰ç«¯æŠ€è¡“æ£§
```javascript
- React 18.3.1          // ç¾ä»£åŒ–å‰ç«¯æ¡†æ¶
- Vite 7.1.2            // å¿«é€Ÿå»ºç½®å·¥å…·
- Tailwind CSS 3.4.10   // å¯¦ç”¨å·¥å…·å„ªå…ˆçš„CSSæ¡†æ¶
- Framer Motion 12.23.12 // å‹•ç•«å’Œæ‰‹å‹¢åº«
- React Router 6.26.1    // å–®é æ‡‰ç”¨è·¯ç”±
```

### å¾Œç«¯æŠ€è¡“æ£§
```python
- FastAPI               // é«˜æ•ˆèƒ½Python Webæ¡†æ¶
- OpenAI API 4.67.3     // AIèªè¨€æ¨¡å‹æ•´åˆ
- Uvicorn              // ASGIä¼ºæœå™¨
- Python 3.11+         // ç¾ä»£Pythonç‰ˆæœ¬
```

### éƒ¨ç½²æ¶æ§‹
```yaml
Frontend:    Vercel           # éœæ…‹ç¶²ç«™è¨—ç®¡
Backend:     Fly.io (ä¸»è¦)    # å®¹å™¨åŒ–éƒ¨ç½²ï¼Œå…¨çƒCDN
Backup:      Render (å‚™ç”¨)    # Pythonæ‡‰ç”¨éƒ¨ç½²
API:         RESTful + SSE    # å³æ™‚é€šè¨Šå”å®š
Failover:    è‡ªå‹•å®¹éŒ¯åˆ‡æ›     # æ™ºèƒ½å¾Œç«¯é¸æ“‡
```

## ğŸš€ å¿«é€Ÿé–‹å§‹

### å‰ç½®éœ€æ±‚
- Node.js >= 18
- Python >= 3.11
- OpenAI API Key

### 1. å°ˆæ¡ˆè¨­å®š

```bash
# è¤‡è£½å°ˆæ¡ˆ
git clone https://github.com/ä½ çš„ç”¨æˆ¶å/metro-ai-assistant.git
cd metro-ai-assistant

# å®‰è£å‰ç«¯ä¾è³´
npm install

# å®‰è£å¾Œç«¯ä¾è³´
pip install -r api/requirements.txt
```

### 2. ç’°å¢ƒè®Šæ•¸é…ç½®

å»ºç«‹ `.env` æª”æ¡ˆï¼š
```bash
# OpenAI API é…ç½®
OPENAI_API_KEY=your_openai_api_key_here
```

### 3. æœ¬åœ°é–‹ç™¼

**å•Ÿå‹•å¾Œç«¯æœå‹™** (çµ‚ç«¯æ©Ÿ 1):
```bash
npm run dev:api
# API å°‡åœ¨ http://localhost:3001 é‹è¡Œ
```

**å•Ÿå‹•å‰ç«¯æœå‹™** (çµ‚ç«¯æ©Ÿ 2):
```bash
npm run dev
# å‰ç«¯å°‡åœ¨ http://localhost:5173 é‹è¡Œ
```

### 4. æ¸¬è©¦ API
```bash
npm test
```

## ğŸ“š API æ–‡æª”

### ğŸ” API ç«¯é»æ¦‚è¦½

| ç«¯é» | æ–¹æ³• | åŠŸèƒ½ | èªªæ˜ |
|------|------|------|------|
| `/api/health` | GET | å¥åº·æª¢æŸ¥ | æª¢æŸ¥æœå‹™ç‹€æ…‹ |
| `/api/stt` | POST | èªéŸ³è½‰æ–‡å­— | éŸ³è¨Šæª”æ¡ˆè½‰æ–‡å­— |
| `/api/ask` | POST | AI å•ç­” | æ™ºèƒ½å•ç­”æœå‹™ |
| `/api/voice-ask` | POST | èªéŸ³å•ç­” | æ•´åˆèªéŸ³+AIå•ç­” |
| `/api/tts` | POST | æ–‡å­—è½‰èªéŸ³ | æ–‡å­—è½‰éŸ³è¨Šæª”æ¡ˆ |

### ğŸ¤– AI å•ç­” API

**ç«¯é»**: `POST /api/ask`

**è«‹æ±‚æ ¼å¼**:
```json
{
  "question": "å¾å°åŒ—è»Šç«™åˆ°101è¦æ€éº¼æ­ï¼Ÿ",
  "mode": "work"  // "work" æˆ– "travel"
}
```

**å›æ‡‰æ ¼å¼**:
```json
{
  "success": true,
  "answer": "å¾å°åŒ—è»Šç«™åˆ°å°åŒ—101ï¼Œå»ºè­°è·¯ç·šå¦‚ä¸‹...",
  "mode": "work",
  "timestamp": "2024-01-01T00:00:00.000Z",
  "question": "å¾å°åŒ—è»Šç«™åˆ°101è¦æ€éº¼æ­ï¼Ÿ"
}
```

### ğŸ—£ï¸ èªéŸ³è½‰AIå•ç­” API

**ç«¯é»**: `POST /api/voice-ask`

**è«‹æ±‚æ ¼å¼**: `multipart/form-data`
- `audio`: éŸ³è¨Šæª”æ¡ˆ
- `mode`: æ¨¡å¼é¸æ“‡ (å¯é¸)

**å›æ‡‰æ ¼å¼**: Server-Sent Events (SSE)
```javascript
// é€£æ¥ç¢ºèª
data: {"type":"connected","message":"é€£æ¥å·²å»ºç«‹"}

// èªéŸ³è½‰æ–‡å­—çµæœ
data: {"type":"stt_result","text":"è½‰éŒ„çš„æ–‡å­—"}

// AIå›æ‡‰ç‰‡æ®µ (ä¸²æµ)
data: {"type":"ai_response_chunk","chunk":"å›æ‡‰ç‰‡æ®µ"}

// å®Œæ•´å›æ‡‰
data: {"type":"ai_response_complete","fullResponse":"å®Œæ•´AIå›æ‡‰"}
```

## ğŸŒ éƒ¨ç½²è³‡è¨Š

### ç·šä¸Šæœå‹™

| æœå‹™ | ç¶²å€ | ç‹€æ…‹ | èªªæ˜ |
|------|------|------|------|
| **å‰ç«¯æ‡‰ç”¨** | [metro-sense.vercel.app](https://metro-sense.vercel.app) | ğŸŸ¢ é‹è¡Œä¸­ | React å‰ç«¯æ‡‰ç”¨ |
| **ä¸»è¦å¾Œç«¯API** | [metro-sense.fly.dev](https://metro-sense.fly.dev/docs) | ğŸŸ¢ é‹è¡Œä¸­ | Fly.io å®¹å™¨åŒ–éƒ¨ç½² |
| **å‚™ç”¨å¾Œç«¯API** | [metro-sense.onrender.com](https://metro-sense.onrender.com/docs) | ğŸŸ¡ å‚™ç”¨ | Render Python éƒ¨ç½² |

### ğŸ”„ è‡ªå‹•å®¹éŒ¯åˆ‡æ›æ©Ÿåˆ¶

å‰ç«¯æ‡‰ç”¨å…·å‚™æ™ºèƒ½å¾Œç«¯é¸æ“‡åŠŸèƒ½ï¼š
- **ä¸»è¦æœå‹™**: å„ªå…ˆä½¿ç”¨ Fly.io (æ›´å¿«çš„å…¨çƒ CDN)
- **è‡ªå‹•æª¢æ¸¬**: 1ç§’å…§æª¢æ¸¬ä¸»è¦æœå‹™å¯ç”¨æ€§
- **ç„¡ç¸«åˆ‡æ›**: ä¸»è¦æœå‹™ä¸å¯ç”¨æ™‚è‡ªå‹•åˆ‡æ›åˆ° Render
- **é€æ˜é«”é©—**: ç”¨æˆ¶ç„¡æ„ŸçŸ¥çš„æœå‹™åˆ‡æ›

### éƒ¨ç½²æŒ‡ä»¤

#### å‰ç«¯éƒ¨ç½²åˆ° Vercel
```bash
npm run deploy
```

#### å¾Œç«¯éƒ¨ç½²é¸é …

**é¸é … 1: éƒ¨ç½²åˆ° Fly.io (æ¨è–¦)**
```bash
# ä½¿ç”¨è‡ªå‹•åŒ–éƒ¨ç½²è…³æœ¬
./deploy-fly.sh

# æˆ–æ‰‹å‹•éƒ¨ç½²
fly launch --no-deploy
fly secrets set OPENAI_API_KEY="your_api_key"
fly deploy
```

**é¸é … 2: éƒ¨ç½²åˆ° Render (å‚™ç”¨)**
- é€£æ¥ GitHub å­˜å„²åº«
- è¨­å®šç’°å¢ƒè®Šæ•¸ `OPENAI_API_KEY`
- è‡ªå‹•éƒ¨ç½²

### ğŸ“š è©³ç´°æŒ‡å—

- **Fly.io éƒ¨ç½²**: è«‹åƒè€ƒ [FLY-DEPLOYMENT.md](FLY-DEPLOYMENT.md)
- **Render éƒ¨ç½²**: è«‹åƒè€ƒ [DEPLOYMENT.md](DEPLOYMENT.md)

### ğŸ”§ æœå‹™æ¯”è¼ƒ

| åŠŸèƒ½ | Fly.io | Render |
|------|--------|--------|
| **å†·å•Ÿå‹•æ™‚é–“** | < 1ç§’ | 10-30ç§’ |
| **å…¨çƒåˆ†ä½ˆ** | âœ… å¤šå€åŸŸ | âŒ å–®ä¸€å€åŸŸ |
| **è‡ªå‹•ç¸®æ”¾** | âœ… å³æ™‚ | âœ… åŸºæœ¬ |
| **å…è²»é¡åº¦** | 3å€‹å…±äº«CPUæ‡‰ç”¨ | 750å°æ™‚/æœˆ |
| **å®¹å™¨æ”¯æ´** | âœ… å®Œæ•´Docker | âš ï¸ æœ‰é™åˆ¶ |
| **æŒä¹…åŒ–å­˜å„²** | âœ… Volumes | âŒ ç„¡ |

## ğŸ”§ é–‹ç™¼æŒ‡å—

### å°ˆæ¡ˆçµæ§‹
```
metro-ai-assistant/
â”œâ”€â”€ api/                    # å¾Œç«¯ FastAPI æ‡‰ç”¨
â”‚   â”œâ”€â”€ main.py            # ä¸»æ‡‰ç”¨ç¨‹å¼
â”‚   â”œâ”€â”€ requirements.txt    # Python ä¾è³´
â”‚   â””â”€â”€ js/                # Node.js ç‰ˆæœ¬ (å‚™ç”¨)
â”œâ”€â”€ src/                   # å‰ç«¯ React æ‡‰ç”¨
â”‚   â”œâ”€â”€ components/        # å¯é‡ç”¨å…ƒä»¶
â”‚   â”œâ”€â”€ pages/            # é é¢å…ƒä»¶
â”‚   â”œâ”€â”€ hooks/            # è‡ªå®šç¾© Hooks
â”‚   â”œâ”€â”€ services/         # API æœå‹™
â”‚   â””â”€â”€ contexts/         # React Contexts
â”œâ”€â”€ docs/                 # æ–‡æª”å’Œåœ–ç‰‡
â”œâ”€â”€ public/               # éœæ…‹è³‡æº
â”œâ”€â”€ dist/                 # å»ºç½®è¼¸å‡º
â””â”€â”€ test/                 # æ¸¬è©¦æª”æ¡ˆ
```

### é–‹ç™¼å»ºè­°

1. **ç¨‹å¼ç¢¼é¢¨æ ¼**: éµå¾ª ESLint å’Œ Prettier è¨­å®š
2. **æäº¤è¨Šæ¯**: ä½¿ç”¨èªç¾©åŒ–æäº¤è¨Šæ¯
3. **åˆ†æ”¯ç­–ç•¥**: ä½¿ç”¨ Git Flow å·¥ä½œæµç¨‹
4. **æ¸¬è©¦è¦†è“‹**: ç¶­æŒé©ç•¶çš„æ¸¬è©¦è¦†è“‹ç‡

### æŠ€è¡“ç‰¹è‰²

- **ğŸš€ é«˜æ•ˆèƒ½**: Vite å¿«é€Ÿå»ºç½®ï¼ŒFastAPI é«˜æ•ˆå¾Œç«¯
- **ğŸ“± éŸ¿æ‡‰å¼**: æ”¯æ´æ¡Œé¢å’Œè¡Œå‹•è£ç½®
- **ğŸ”„ å³æ™‚äº’å‹•**: SSE ä¸²æµæŠ€è¡“æä¾›å³æ™‚å›æ‡‰
- **ğŸ›¡ï¸ å®‰å…¨æ€§**: CORS è¨­å®šï¼Œæª”æ¡ˆå¤§å°é™åˆ¶
- **â™¿ ç„¡éšœç¤™**: éµå¾ª WCAG æŒ‡å°åŸå‰‡
- **ğŸ”„ æ™ºèƒ½å®¹éŒ¯**: è‡ªå‹•å¾Œç«¯åˆ‡æ›ï¼Œ99.9% æœå‹™å¯ç”¨æ€§
- **ğŸŒ å…¨çƒåŠ é€Ÿ**: Fly.io CDN æä¾›æœ€ä½³å»¶é²é«”é©—
- **ğŸ“Š æœå‹™ç›£æ§**: å³æ™‚å¥åº·æª¢æŸ¥å’Œç‹€æ…‹ç›£æ§

## ğŸ“„ æˆæ¬Šæ¢æ¬¾

æœ¬å°ˆæ¡ˆæ¡ç”¨ MIT æˆæ¬Šæ¢æ¬¾ - è©³è¦‹ [LICENSE](LICENSE) æª”æ¡ˆ

---

<div align="center">

**ğŸš‡ è®“æ¯ä¸€æ¬¡å‡ºè¡Œéƒ½è®Šå¾—æ›´åŠ ä¾¿æ·é«˜æ•ˆï¼**

Made with â¤ï¸ for Taipei Metro users

[å›åˆ°é ‚éƒ¨](#-å°åŒ—æ·é‹æ™ºèƒ½åŠ©æ‰‹-metro-ai-assistant)

</div>
